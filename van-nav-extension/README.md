# Van Nav 浏览器扩展

快速将当前浏览的网页添加到 Van Nav 导航站的浏览器扩展。

## 功能特性

- 🚀 **一键添加**：快速添加当前网页到导航站
- ⚡ **快捷键支持**：使用 `Ctrl+E` (Windows/Linux) 或 `Command+E` (Mac) 快速打开扩展
- 🔄 **自动填充**：自动获取页面标题、URL和图标
- 📁 **分类管理**：
  - 下拉选择大分类和子分类
  - 一键快速新增分类
  - 级联选择，先选大分类再选子分类
  - 新增分类后自动选中
- 🎨 **智能图标管理**：
  - 从网页自动获取 favicon
  - 本地选择图片
  - 智能上传：可上传当前显示的任何图片到服务器
  - API获取网站图标
  - 随机获取精美图标（1600+可选）
  - 手动刷新图标
  - 自动处理跨域图片
- ⚙️ **灵活配置**：自定义服务器地址、API令牌和快捷键
- 🔒 **安全存储**：使用Chrome同步存储保存配置
- ⚠️ **友好提示**：Token未配置时醒目提示
- ✅ **操作反馈**：添加成功后明确提示并自动关闭

## 安装方法

### 开发者模式安装

1. 下载或克隆本项目
2. 打开 Chrome 浏览器，访问 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择 `van-nav-extension` 文件夹
6. 扩展安装完成！

### 后续打包发布

可以打包为 `.crx` 文件分发，或发布到 Chrome Web Store。

## 使用说明

### 首次配置

1. 点击扩展图标，点击"⚙️ 设置"按钮
2. 填写 Van Nav 服务器地址（默认：119.91.23.95）
3. 填写端口号（默认：6412）
4. 在 Van Nav 后台生成 API Token 并填入
5. 勾选"启用快捷键"（默认启用）
6. 点击"🔍 测试连接"确认配置正确
7. 保存设置

### 添加书签

#### 方法一：使用快捷键（推荐）
1. 浏览任意网页
2. 按下 `Ctrl+E` (Windows/Linux) 或 `Command+E` (Mac)
3. 扩展会自动打开并填充信息

#### 方法二：点击图标
1. 浏览任意网页
2. 点击浏览器工具栏中的 Van Nav 扩展图标

#### 填写信息
3. 扩展会自动填充：
   - **名称**：页面标题
   - **链接**：页面URL（去除参数）
   - **图标**：自动获取网站图标
4. 可选填写：
   - **简介**：书签描述
   - **大分类**：从下拉选择或点击"+ 新增"创建
   - **子分类**：从下拉选择或点击"+ 新增"创建
5. 点击"添加到导航站"完成
6. 看到"✅ 添加成功！"提示后自动关闭

### 图标功能

- **📁 选择**：从本地选择图片文件
- **☁️ 上传**：将当前显示的图片上传到服务器（支持任何来源的图片）
- **🔗 API**：使用API从网站URL获取图标
- **🎲 随机**：从15个精美图标库中随机获取
- **🔄 刷新**：重新加载当前图标URL

> 💡 **上传功能说明**：无论图标来自何处（自动获取的 favicon、API获取、随机图标、本地选择），点击"上传"按钮都会将当前显示的图片上传到图床服务器，并自动更新图标URL。这样可以确保图标的长期稳定性。

## 图标库说明

扩展内置15个精美图标库，包含超过1500个图标：
- 进击的巨人
- 数码宝贝
- 哆啦A梦
- 原神
- 樱桃小丸子
- 火影忍者
- 海贼王
- 宝可梦
- 四宫辉夜
- 蜡笔小新
- 史迪奇
- 猫和老鼠
- 变形金刚
- 喜羊羊与灰太狼

## 技术栈

- **Manifest V3**：最新的浏览器扩展标准
- **原生JavaScript**：无需框架，轻量高效
- **Chrome Storage API**：配置同步存储
- **Chrome Scripting API**：页面信息获取
- **Fetch API**：网络请求

## 项目结构

```
van-nav-extension/
├── manifest.json           # 扩展配置文件
├── popup/
│   ├── popup.html         # 弹出界面
│   ├── popup.css          # 样式文件
│   └── popup.js           # 主逻辑
├── options/
│   ├── options.html       # 设置页面
│   ├── options.css        # 设置页面样式
│   └── options.js         # 设置页面逻辑
├── background.js          # 后台脚本
├── utils/
│   ├── api.js            # API调用封装
│   ├── icon-provider.js  # 图标获取工具
│   └── storage.js        # 存储管理
└── icons/
    ├── icon16.png        # 扩展图标 16x16
    ├── icon48.png        # 扩展图标 48x48
    └── icon128.png       # 扩展图标 128x128
```

## 常见问题

### 1. 无法连接到服务器？

- 检查服务器地址和端口是否正确
- 确认 Van Nav 服务正在运行
- 检查防火墙设置
- 使用"测试连接"功能诊断问题

### 2. API Token 在哪里生成？

在 Van Nav 后台管理界面的"API Token"标签页中生成。

### 3. 添加书签失败？

- 确认 API Token 是否正确
- 检查网络连接
- 查看浏览器控制台的错误信息

### 4. 图标显示失败？

- 尝试使用"API获取"按钮重新获取
- 或者使用"随机"功能选择其他图标
- 也可以手动输入图标URL

## 更新日志

### v1.0.0 (2025-11-06)

- 🎉 首次发布
- ✨ 支持一键添加书签
- 🖼️ 多种图标获取方式
- ⚙️ 灵活的配置选项
- 🔒 安全的存储机制

## 开发者

本扩展是 [Van Nav Enhanced](https://github.com/DeerFishSheep/van-nav-enhanced) 项目的配套工具。

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！

